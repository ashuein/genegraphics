<md-content class="md-padding">
	<div ng-controller="graphCtrl">
	<md-toolbar class="md-menu-toolbar">
	<md-menu-bar id="mainmenubar">
		<md-menu>
			<button ng-click="$mdOpenMenu()" class="btn1 md-button md-raised md-primary">
				Input
			</button>
			<md-menu-content width="100px" ng-controller="FileCtrl">
				<md-menu-item >
					<input type="file" name="file" id="file" class="inputfile" on-read-file="parseFile($fileContent, $fileType)"/>
					<label for="file" class="md-button btn2" role="menuitem">
						Choose a File
					</label>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" ng-click="showWebGenomePopup();">
							Choose a Genome
					</button>
				</md-menu-item>
				<md-menu-item>
					<md-menu>
						<button class="md-button btn3" ng-click="$mdOpenMenu()">Tutorial Files</button>
						<md-menu-content>
							<md-menu-item>
								<button class="md-button btn2" ng-click="tutorialFile('data/tutorial1/tutorial1_inputTable.tsv','tsv');">
									Tutorial 1 Unfinished
								</button>
							</md-menu-item>
							<md-menu-item>
								<button class="md-button btn2" ng-click="tutorialFile('data/tutorial1/tutorial1_finalproduct.tsv','tsv');">
									Tutorial 1 Finished
								</button>
							</md-menu-item>
						</md-menu-content>
					</md-menu>
				</md-menu-item>
				<md-menu-item >
					<button class="md-button btn2" ng-click="clearAllGenomes();">
							Clear All Genomes
					</button>
				</md-menu-item>
			</md-menu-content>
		</md-menu>
		<md-menu>
			<button ng-click="$mdOpenMenu()" class="btn1 md-button md-raised md-primary">
				Graph Settings
			</button>
			<md-menu-content width="150px">
				<h4>Size settings</h4>
				<md-menu-item>
					<button class="md-button btn2" md-prevent-menu-close="md-prevent-menu-close">
						<span>Image width</span>
						<span><input type="text" id="widthtxt" step=10 ng-model="graphSettings.graphwidth" update-on-enter ng-model-options="{ updateOn: 'blur' }" ng-change="changeGraphWidth(graphSettings.graphwidth);" > px</span>
					</button>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" md-prevent-menu-close="md-prevent-menu-close">
						<span>Gene height</span>
						<span><input type="text" id="featureheighttxt" ng-model="graphSettings.featureheight" update-on-enter ng-model-options="{ updateOn: 'blur' }" ng-change="changeFeatureHeight(graphSettings.featureheight);"> px</span>
					</button>
				</md-menu-item>
				<md-menu-item>
					<span style = "font-style:italic; font-size:10px">Press [Enter] to apply changes.</span>
				</md-menu-item>
				<md-menu-divider></md-menu-divider>
				<h4>Lane settings</h4>
				<md-menu-item>
					<button class="md-button btn2" md-prevent-menu-close="md-prevent-menu-close"><md-checkbox ng-model="graphSettings.multilane" ng-click="clickMultiLane()" md-prevent-menu-close="md-prevent-menu-close">Multiple lanes for overlapping genes</button>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" ng-disabled="graphSettings.multilane" md-prevent-menu-close="md-prevent-menu-close"><md-checkbox ng-disabled="graphSettings.multilane" ng-model="graphSettings.shiftgenes" ng-click="clickShiftgenes()" md-prevent-menu-close="md-prevent-menu-close">Shift overlapping genes</button>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" ng-disabled="!graphSettings.shiftgenes" md-prevent-menu-close="md-prevent-menu-close"><md-checkbox ng-disabled="!graphSettings.shiftgenes" ng-model="graphSettings.keepgaps" md-prevent-menu-close="md-prevent-menu-close">keep gaps between genes</button>
				</md-menu-item>
				<md-menu-divider></md-menu-divider>
				<h4>Scale</h4>
				<md-menu-item>
					<button class="md-button btn2"md-prevent-menu-close="md-prevent-menu-close"><md-checkbox ng-model="graphSettings.scaleOn"md-prevent-menu-close="md-prevent-menu-close">Scale on</button>
				</md-menu-item>
			</md-menu-content>
		</md-menu>
		<md-menu>
			<button ng-click="$mdOpenMenu()" class="btn1 md-button md-raised md-primary">
				Label Settings
			</button>
			<md-menu-content>
				<h4>Font Defaults</h4>
				<md-menu-item>
					<button class="md-button btn2"md-prevent-menu-close="md-prevent-menu-close">
						<span>Font size</span>
						<span style="white-space:nowrap"><input type="number" ng-model="graphSettings.fontSize" min="5" max="32"> px
					</button>
				</md-menu-item>
				<md-menu-item>
					<md-menu>
						<button class="md-button btn3" ng-click="$mdOpenMenu()">Font Family</button>
							<md-menu-content>
							<md-radio-group ng-model="graphSettings.fontFamily">
								<button class="md-button rbtn" ng-repeat-start="d in graphSettings.fontFamilyOptions"md-prevent-menu-close="md-prevent-menu-close">
									<md-radio-button ng-value="d.value" aria-label="{{ d.name }}" md-prevent-menu-close="md-prevent-menu-close"> {{d.name}} </md-radio-button>
								</button>
								<div ng-repeat-end></div>
							</md-radio-group>
						</md-menu-content>
					</md-menu>
				</md-menu-item>
				<md-menu-item>
					<md-menu>
						<button class="md-button btn3" ng-click="$mdOpenMenu()">Font Style</button>
							<md-menu-content>
							<md-radio-group ng-model="graphSettings.fontStyle">
								<button class="md-button rbtn" ng-repeat-start="d in graphSettings.fontStyleOptions" md-prevent-menu-close="md-prevent-menu-close">
									<md-radio-button ng-value="d.value" aria-label="{{ d.name }}"md-prevent-menu-close="md-prevent-menu-close"> {{d.name}} </md-radio-button>
								</button>
								<div ng-repeat-end></div>
							</md-radio-group>
						</md-menu-content>
					</md-menu>
				</md-menu-item>
				<md-menu-divider></md-menu-divider>
				<h4>Label Defaults</h4>
				<md-menu-item>
					<md-menu>
						<button class="md-button btn2" ng-click="$mdOpenMenu()">Position</button>
						<md-menu-content>
							<md-radio-group ng-model="graphSettings.labelPosition">
								<button class="md-button rbtn" ng-repeat-start="d in graphSettings.labelPosOptions" md-prevent-menu-close="md-prevent-menu-close">
									<md-radio-button ng-value="d.value" aria-label="{{ d.name }}"md-prevent-menu-close="md-prevent-menu-close"> {{d.name}} </md-radio-button>
								</button>
								<div ng-repeat-end></div>
							</md-radio-group>
						</md-menu-content>
					</md-menu>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" type="button" value="hide all labels" ng-click="changeAllLabels(true);" "md-prevent-menu-close="md-prevent-menu-close">Hide all labels</button>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" type="button" value="show all labels" ng-click="changeAllLabels(false);" "md-prevent-menu-close="md-prevent-menu-close">Show all labels</button>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" type="button" value="black labels" ng-click="colorAllLabels('#000000');" "md-prevent-menu-close="md-prevent-menu-close">Black labels</button>
				</md-menu-item>
				<md-menu-item>
					<button class="md-button btn2" type="button" value="white labels" ng-click="colorAllLabels('#ffffff');" "md-prevent-menu-close="md-prevent-menu-close">White labels</button>
				</md-menu-item>
			</md-menu-content>
		</md-menu>
		<button ng-exportbutton class="btn1 md-button md-raised md-primary" ng-click="openExportPanel();" data="geneData" settings="graphSettings" showexportpanel="showExportPanel">
			Export
		</button>
		<span style="float:right;">{{graphSettings.displayedFunction}}</span>
	</md-menu-bar>
</md-toolbar>
	<div id="graphcontainer">
		<d3-genes data="geneData" settings="graphSettings" genomeshidestatus="genomesHideStatus" on-click="selectGene(index, x, y)" on-click-genome="selectGenome(genomeindex, wordindex, x, y)" on-mouse-over-gene="changeDisplayedFunction(newfunction)" on-drag="dragLabel(i, newx, newy)"></d3-genes>
	</div>
	<div>Files: 
		<span ng-hide="graphSettings.currentFilesList.length">No file chosen</span>
		<span ng-repeat="file in graphSettings.currentFilesList">{{file}}{{$last ? '' : ', '}}</span>
	</div>
	<div id="popupbox" ng-controller="FileCtrl" ng-show="showPopupMenu">
		<button class="xoutbutton md-fab md-mini" ng-click="closePopup(-1);">
				<md-icon class="material-icons blueicon md-18">close</md-icon>
		</button>
		Import Genbank File from NCBI<br>
		Genbank ID: <input type="text" ng-model="genbankID" style="width: 140px;"/><br>
		Region:<br> 
		<form action="">
			<input type="radio" name="sequence" label="whole" value="whole" ng-model="seqRange" selected="true">Whole sequence<br>
			<input type="radio" name="sequence" label="custom" value="custom" ng-model="seqRange" >Custom region:<br>	
		</form>
			from: <input type="number" ng-model="seqRangeStart"> to: <input type="number" ng-model="seqRangeEnd"><br>
		<button class="md-button md-raised md-primary" ng-click="submitNCBIQuery();" style="right:0;">Submit</button><br>
		<span id="statusmessage">{{statusMessage}}</span>
	</div>
	<div id="popupbox" ng-show="showExportPanel">
		<button class="xoutbutton md-fab md-mini" ng-click="closeExportPanel();">
				<md-icon class="material-icons blueicon md-18">close</md-icon>
		</button>
		To save a file, right click on the link and choose "Save As". (On Mac:âŒ˜ + click and "Download linked file as..." Then, give the file a name and the correct file extension on the save prompt.)<br><br>
		<a id="pnglink" href="" download="newgenegraphic.png">Export PNG</a><br><br>
		<a id="svglink" href="" download="newgenegraphic.svg">Export SVG</a><br><br>
		<a id="tsvlink" href="" download="newgenegraphic.tsv">Export TSV</a><br>
	</div>
	<div id="geneMenu" ng-click="$emit('menuClicked', event.target)" ng-show="menuVisible == true">
		<div ng-show="(selectedGene >= 0) && menuVisible == true">
			<h4>Selected gene options</h4> 
			Name: <input type="text" ng-model="geneData[selectedGene]['name']" /><br>
			Colors<br>
			Gene: <spectrum-colorpicker format="'hex'" ng-model="geneData[selectedGene]['color']"></spectrum-colorpicker><input type="text" ng-model="geneData[selectedGene]['color']"><br>
			Label: <spectrum-colorpicker format="'hex'" ng-model="geneData[selectedGene]['labelcolor']" ng-change="changeLabelColor(selectedGene);" ></spectrum-colorpicker><input type="text" ng-model="geneData[selectedGene]['labelcolor']">
			<select ng-model="geneData[selectedGene]['labelstyle']" ng-change="changeLabelStyle(selectedGene)">
				<option value='normal'>Normal</option>
				<option value='italic'><i>Italic</i></option>
				<option value='bold'><b>Bold</b></option>
				<option value='bold,italic'><b><i>Bold/Italic</b></i></option>
			</select><br>
			Hide label: <input type="checkbox" ng-model="geneData[selectedGene]['labelhidden']">
			Hide gene: <input type="checkbox" ng-model="geneData[selectedGene]['genehidden']"><br>
			<button class="btn1 md-button md-raised md-primary" ng-click="copyGeneAttrs(selectedGene);">Copy Gene Colors</button>
			<button class="btn1 md-button md-raised md-primary" ng-click="pasteGeneAttrs(selectedGene);">Paste Gene Colors</button>
			
		</div>
		<div ng-show="selectedGenome >= 0 && menuVisible == true">
			{{geneData[selectedGenome]['genome'][selectedWord]}}<br>
			Style: 
			<select ng-model="geneData[selectedGenome]['genomestyles'][selectedWord]">
				<option value='normal'>Normal</option>
				<option value='italic'><i>Italic</i></option>
				<option value='bold'><b>Bold</b></option>
				<option value='bold,italic'><b><i>Bold/Italic</b></i></option>
			</select>
		</div>
	</div>
</div>
</md-content>